import time

import pandas as pd

HELLO = """–ü—Ä–∏–≤–µ—Ç —è –±–æ—Ç, –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—â–∏–π —Å—Å–æ–±—â–µ–Ω–∏—è –∏ –≤—ã–¥–∞—é—â–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞"""
MAX_LEVEL = """–û, –ø–æ—Ö–æ–∂–µ –≤—ã —É–∂–µ –¥–æ—Å—Ç–∏–≥–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è"""
REPLY_ANSWER = "–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ!"

dct_lvl_up = {
    1: "—Å–æ–æ–±—â–µ–Ω–∏–µ",
    2: "—Å–æ–æ–±—â–µ–Ω–∏—è",
    3: "—Å–æ–æ–±—â–µ–Ω–∏—è",
    4: "—Å–æ–æ–±—â–µ–Ω–∏—è"
}

HELP = "–í–æ—Ç –≤—Å—ë —á—Ç–æ —è —É–º–µ—é\n\n/help - —É–∑–Ω–∞—Ç—å —á—Ç–æ —è —É–º–µ—é\n\n/lvl - –ø–æ–≤—ã—Å–∏—Ç—å —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å\n" + \
       "\n/karma - —É–∑–Ω–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å —Å–≤–æ–µ–π –∫–∞—Ä–º—ã\n\n/ban - –∑–∞–±–∞–Ω–∏—Ç—å —á–µ–ª–æ–≤–µ–∫–∞\n(—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)"


def lvl_up(lvl: int):
    return f"–í–∞—à —É—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω –¥–æ {lvl}!‚ú®"


def not_suffice_to_level_up(count):
    if count in dct_lvl_up.keys():
        return f"–î–æ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –≤–∞–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –µ—â—ë {count} {dct_lvl_up[count]}!"
    else:
        return f"–î–æ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –≤–∞–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –µ—â—ë {count} —Å–æ–æ–±—â–µ–Ω–∏–π!"


def you_karma(karma):
    if karma <= 0:
        return f"–ú–Ω–µ –∂–∞–ª—å, —Å–µ–π—á–∞—Å –≤–∞—à–∞ –∫–∞—Ä–º–∞ {karma}"
    else:
        return f"–°–µ–π—á–∞—Å –≤–∞—à–∞ –∫–∞—Ä–º–∞ —Ä–∞–≤–Ω–∞ {karma}"


def info(quantity_messages: int, quantity_people: int, mean_lvl: int, mean_karma: int):
    return f"üí¨–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ —á–∞—Ç–µ {quantity_messages} —Å–æ–æ–±—â–µ–Ω–∏–π.üí¨\n" +\
        f"üë§–°–µ–π—á–∞—Å –≤ —á–∞—Ç–µ {quantity_people} –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–πüë§\n" +\
        f"üîù–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {mean_lvl}üîù\n" +\
        f"‚ò†–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–∞—Ä–º—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π–π: {mean_karma}üëº"


def not_update_karma(karma_time, timing):
    return "–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Ä–º—É –Ω–µ —á–∞—â–µ, —á–µ–º —Ä–∞–∑ –≤ —á–∞—Å\n" + \
        f"PS. –°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —á–µ—Ä–µ–∑ {karma_time + timing - int(time.time())}"


def most_activity_people_in_chat(df: pd.DataFrame):
    text = "–°–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ª—é–¥–∏ —á–∞—Ç–∞:\n"
    lst = list(df.columns)
    name = lst.index("name")
    # print(name)
    count = lst.index("message_count")
    k = 0
    for i in df.itertuples(index=False):
        k += 1
        if k == 1:
            text += f"ü•á){i[name].capitalize()} - {i[count]}\n"
        elif k == 2:
            text += f"ü•à){i[name].capitalize()} - {i[count]}\n"
        elif k == 3:
            text += f"ü•â){i[name].capitalize()} - {i[count]}\n"
        else:
            text += f"{k}){i[name].capitalize()} - {i[count]}\n"
    return text


def reply_update_action_points(point):
    return f"–í–∞—à–∏ –æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –æ–±–Ω–∞–≤–ª–µ–Ω—ã –¥–æ {point}"


def reply_no_update_action_points(time_):
    if time_ % 24:
        return f"–í–∞—à–∏ –æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ {time_ // 3600} —á–∞—Å–æ–≤ –∏ {time_ % 3660 // 60} –º–∏–Ω—É—Ç {time_ % 60}"
    if time_ % 60:
        return f"–í–∞—à–∏ –æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ {time_ % 3600 // 60} –º–∏–Ω—É—Ç –∏ {time_ % 60} —Å–µ–∫—É–Ω–¥"
    else:
        return f"–í–∞—à–∏ –æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ {time_ % 60} —Å–µ–∫—É–Ω–¥"